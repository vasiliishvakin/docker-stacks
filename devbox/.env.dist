# Devbox Environment Configuration
# Copy this file to .env and configure with your values
# Documentation: https://github.com/vasiliishvakin/docker-stacks

# ============================================================================
# REQUIRED CONFIGURATION
# ============================================================================

# SSH public key for authentication (required for SSH access)
# Paste your public key here (contents of ~/.ssh/id_rsa.pub or similar)
# Example: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQ... user@hostname
SSH_PUBLIC_KEY=

# ============================================================================
# NETWORK CONFIGURATION
# ============================================================================

# Network mode for devbox container
# Options:
#   - container:tailscale  (use existing Tailscale container network - recommended for security)
#   - bridge               (use standard bridge network)
# Note: When using container:tailscale, ensure the Tailscale stack is running first
NETWORK_MODE=container:tailscale

# ============================================================================
# DEVBOX CONFIGURATION
# ============================================================================

# PHP version for the devbox image
# Options: php8.1, php8.2, php8.3, php8.4
# Default: php8.3
PHP_VERSION=php8.3

# Devbox Docker image
# Default: vasiliishvakin/devbox:${PHP_VERSION}-latest
CADDY_IMAGE=vasiliishvakin/devbox:${PHP_VERSION:-php8.3}-latest

# Workspace volume name (must be created externally)
# Add 'workspace' to infrastructure/.env VOLUMES line and run: cd infrastructure && task init
WORKSPACE=workspace

# ============================================================================
# SSH CONFIGURATION
# ============================================================================

# SSH port inside the container (default: 22)
# Note: When using NETWORK_MODE=container:tailscale, configure external port in tailscale/compose.override.yaml
SSH_PORT=22

# ============================================================================
# CONTAINER CONFIGURATION
# ============================================================================

# Container restart policy
# Options: no, always, on-failure, unless-stopped
RESTART_POLICY=unless-stopped

# ============================================================================
# NOTES & USAGE
# ============================================================================

# Volume setup:
# 1. Add 'workspace' to infrastructure/.env VOLUMES line
# 2. Run: cd infrastructure && task init
#
# Or manually:
#   docker volume create workspace

# Accessing Devbox via SSH:
# When using NETWORK_MODE=container:tailscale:
#   - Ensure the Tailscale stack is running: docker ps | grep tailscale
#   - Configure SSH port in tailscale/compose.override.yaml:
#     services:
#       tailscale:
#         ports:
#           - "2222:22"      # SSH (map to different port to avoid conflicts)
#   - Connect via: ssh root@<tailscale-hostname> -p 2222
#   - More secure - only accessible via your Tailscale network
#
# To access via local network instead:
#   - Set NETWORK_MODE=bridge
#   - Add ports section to compose.yaml:
#     ports:
#       - "2222:22"  # SSH
#   - Connect via: ssh root@localhost -p 2222

# What's included in devbox:
# - PHP 8.x with 30+ extensions (Xdebug, Redis, MongoDB, ImageMagick, etc.)
# - Composer with global packages (Deployer, Rector, PHPStan, PHP-CS-Fixer, Laravel)
# - Node.js 25.x with TypeScript, ESLint, Prettier
# - Python 3 with common packages
# - Go and Java
# - MariaDB client
# - Development tools: git, vim, nano, tmux, htop, jq, etc.
# - Image optimization tools: jpegoptim, optipng, webp, libavif

# Prerequisites:
# - SSH public key must be set in SSH_PUBLIC_KEY variable
# - Tailscale stack must be deployed and running first (if using container:tailscale)
# - Check with: docker ps | grep tailscale
# - The tailscale container name must match (default: tailscale)
# - Configure SSH port in tailscale/compose.override.yaml
