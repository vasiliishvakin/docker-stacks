# Tailscale Docker Environment Configuration
# Copy this file to .env and configure with your values
# Documentation: https://tailscale.com/kb/1282/docker

# ============================================================================
# REQUIRED CONFIGURATION
# ============================================================================

# Tailscale Authentication Key
# Generate at: https://login.tailscale.com/admin/settings/keys
# Recommended: Use ephemeral, reusable auth keys with appropriate tags
TS_AUTHKEY=

# Tailscale State Directory (Persistent storage for Tailscale state)
# Named volume: tailscale_data (add to infrastructure/.env VOLUMES)
TAILSCALE_DATA=tailscale_data

# ============================================================================
# NETWORK CONFIGURATION
# ============================================================================

# External Docker network (should match your infrastructure setup)
NETWORK_NAME=shared

# DNS Configuration
# Primary DNS server (default: Cloudflare)
DNS=1.1.1.1

# Fallback DNS server (leave empty to disable)
DNS_FALLBACK=

# Accept DNS configuration from Tailscale (true/false)
# When true, uses DNS servers configured in your tailnet
TS_ACCEPT_DNS=true

# ============================================================================
# TAILSCALE NODE CONFIGURATION
# ============================================================================

# Hostname for this Tailscale node
# This will be the name shown in the Tailscale admin console
TAILSCALE_HOSTNAME=tailscale

# ============================================================================
# ADVANCED TAILSCALE OPTIONS
# ============================================================================

# Advertise as exit node (true/false)
# When true, routes all traffic through this node
TS_ADVERTISE_EXIT_NODE=false

# Advertise subnet routes (comma-separated CIDR notation)
# Example: Make Docker network accessible via Tailscale
# TS_ADVERTISE_ROUTES=172.24.0.0/24
# Multiple subnets: TS_ADVERTISE_ROUTES=172.24.0.0/24,10.0.0.0/24
TS_ADVERTISE_ROUTES=

# Tailscale tags (comma-separated, for ACL management)
# Example: tag:container,tag:server
TS_TAGS=

# Enable SSH via Tailscale (true/false)
# Default: false (SSH is disabled)
TS_SSH=false

# Accept routes advertised by other nodes (true/false)
TS_ACCEPT_ROUTES=false


# ============================================================================
# CONTAINER CONFIGURATION
# ============================================================================

# Container restart policy
# Options: no, always, on-failure, unless-stopped
RESTART_POLICY=unless-stopped

# ============================================================================
# NOTES & EXAMPLES
# ============================================================================

# Example 1: Basic setup with tags
# TS_AUTHKEY=tskey-auth-xxxxx
# TAILSCALE_HOSTNAME=docker-server
# TS_TAGS=tag:server

# Example 2: Exit node setup
# TS_ADVERTISE_EXIT_NODE=true
# TS_TAGS=tag:exit-node

# Example 3: Subnet router for Docker network
# TS_ADVERTISE_ROUTES=172.24.0.0/24
# TS_TAGS=tag:router

# Example 4: Full-featured setup
# TS_ADVERTISE_ROUTES=172.24.0.0/24
# TS_TAGS=tag:container
# TS_ACCEPT_ROUTES=true

# Volume setup:
# Named volume 'tailscale_data' should be added to infrastructure/.env VOLUMES line:
#   VOLUMES=portainer_data traefik_certs tailscale_data
# Then run: cd infrastructure && task init

# Security best practices:
# - Use ephemeral auth keys for temporary nodes
# - Use reusable auth keys with tags for permanent infrastructure
# - Never commit .env file with real auth keys to git
# - Rotate auth keys periodically
# - Use ACLs to restrict access between nodes
